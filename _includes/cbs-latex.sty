% cbs-latex.sty
% {% raw %}

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{cbs-latex}[2021/04/18 CBS-LaTeX package]

% This package uses sans-serif fonts for names in specifications.
% For global sans-serif fonts, use together with the cmbright package.

\RequirePackage{amsmath}
\RequirePackage{amssymb}
\RequirePackage{stmaryrd}
\RequirePackage{textcomp}
\RequirePackage[svgnames]{xcolor}
\RequirePackage{hyperref}
% \hypersetup{filebordercolor={White}}

% The following color names are used by the highlighting macros.
% They are set to colors defined by the svgnames option of xcolor,
% and can be reset locally in LaTeX documents.

\colorlet{Key}{Gray}
\colorlet{Name}{DarkRed}
\colorlet{SyntaxName}{DarkGreen}
\colorlet{SemanticsName}{DarkBlue}
\colorlet{PartVariable}{Black}
\colorlet{SectionNumber}{Black}

% The following definition of \SHADE{TEXT} produces a faint grey background
% for CBS notation in running text:
\newcommand{\SHADE}[1]{{\setlength{\fboxsep}{0pt}\colorbox{gray!10}{$\strut#1\strut$}}}

% \KEY{text}, \STRING{text}, \ATOM{text}, \LEX{text} can be used in text or math mode.

\newcommand{\KEY}[1]{\textsf{\textsl{\STYLE{Key}{#1}}}}
\newcommand{\STRING}[1]{\textsf{``\texttt{#1}''}}
\newcommand{\ATOM}[1]{\textsf{`\texttt{#1}'}}
\newcommand{\LEX}[1]{\textsf{\STYLE{Key}{`}\texttt{#1}\STYLE{Key}{'}}}

% The following commands produce ASCII characters that are treated specially by LaTeX.

\newcommand{\HASH}{\char`\#}
\newcommand{\DOLLAR}{\char`\$}
\newcommand{\PERCENT}{\char`\%}
\newcommand{\AMPERSAND}{\char`\&}
\newcommand{\APOSTROPHE}{\char`\'}
\newcommand{\BACKSLASH}{\char`\\}
\newcommand{\CARET}{\char`\^}
\newcommand{\UNDERSCORE}{\char`\_}
\newcommand{\GRAVE}{\`{}}
\newcommand{\LEFTBRACE}{\char`\{}
\newcommand{\RIGHTBRACE}{\char`\}}
\newcommand{\TILDE}{\char`\~}

% \NAME{name} highlights the name.
% \NAMEDECL{name} declares Name.name as the target of links to name.
% \NAMEREF{name} links name to the target Name.name in the current file.
% \NAMEHYPER{url}{file}{name} links name to Name.name at url/file/file.pdf.
% Similarly for \VAR, \SYN, \SEM, and \SECT.
% N.B. The names of these macros are significant!

\newcommand{\SUB}[1]{_{\text{#1}}}

% PLAIN

\newcommand{\STYLE}[2]{\textcolor{#1}{#2}}

\newcommand{\VAR}[1]{\STYLE{PartVariable}{\textsl{#1\/}}}
\newcommand{\NAME}[1]{\STYLE{Name}{\textsf{#1}}}                 % -> \FUN
\newcommand{\SYN}[1]{\STYLE{SyntaxName}{\textsf{#1}}}
\newcommand{\SEM}[1]{\STYLE{SemanticsName}{\textsf{#1}}}
\newcommand{\SECT}[1]{\STYLE{SectionNumber}{#1}}                 % -> \SEC

% DECL

\newcommand{\DECL}[3]{\raisebox{1.2\ht\strutbox}{\hyperdef{#1}{#2}{}}#3} % -> \DEC

\newcommand{\VARDECL}[1]{\DECL{PartVariable}{#1}{\VAR{#1}}}      % -> \VARDEC
\newcommand{\NAMEDECL}[1]{\DECL{Name}{#1}{\NAME{#1}}}            % -> \FUNDEC
\newcommand{\SYNDECL}[1]{\DECL{SyntaxName}{#1}{\SYN{#1}}}        % -> \SYNDEC
\newcommand{\SEMDECL}[1]{\DECL{SemanticsName}{#1}{\SEM{#1}}}     % -> \SEMDEC
\newcommand{\SECTDECL}[1]{\DECL{SectionNumber}{#1}{\textsf{#1}}} % -> \SECDEC

% REF

\newcommand{\REF}[3]{\hyperref{\jobname}{#1}{#2}{#3}}

\newcommand{\VARREF}[1]{\REF{PartVariable}{#1}{\VAR{#1}}}
\newcommand{\NAMEREF}[1]{\REF{Name}{#1}{\NAME{#1}}}              % -> \FUNREF
\newcommand{\SYNREF}[1]{\REF{SyntaxName}{#1}{\SYN{#1}}}
\newcommand{\SEMREF}[1]{\REF{SemanticsName}{#1}{\SEM{#1}}}
\newcommand{\SECTREF}[1]{\REF{SectionNumber}{#1}{\SECT{#1}}}     % -> \SECREF

% HYPER

\newcommand{\HYPER}[5]{\hyperref{#1/#2/#2}{#3}{#4}{#5}}                  % -> \HYP

\newcommand{\VARHYPER}[3]{\HYPER{#1}{#2}{PartVariable}{#3}{\VAR{#3}}}    % -> \VARHYP
\newcommand{\NAMEHYPER}[3]{\HYPER{#1}{#2}{Name}{#3}{\NAME{#3}}}          % -> \FUNHYP
\newcommand{\SYNHYPER}[3]{\HYPER{#1}{#2}{SyntaxName}{#3}{\SYN{#3}}}      % -> \SYNHYP
\newcommand{\SEMHYPER}[3]{\HYPER{#1}{#2}{SemanticsName}{#3}{\SEM{#3}}}   % -> \SEMHYP
\newcommand{\SECTHYPER}[3]{\HYPER{#1}{#2}{SectionNumber}{#3}{\SECT{#3}}} % -> \SECHYP

% CBS-beta/math hyperlinks

\newcommand{\CBSBETAMATH}{https://plancomps.github.io/CBS-beta/math}     % -> \CBS

\newcommand{\VARHYPERBETA}[3]{\VARHYPER{\CBSBETAMATH/#1}{#2}{#3}}        % -> \VARCBS
\newcommand{\FUNCONHYPERBETA}[3]{\NAMEHYPER{\CBSBETAMATH/#1}{#2}{#3}}    % -> \FUNCBS
\newcommand{\SYNTAXHYPERBETA}[3]{\SYNHYPER{\CBSBETAMATH/#1}{#2}{#3}}     % -> \SYNCBS
\newcommand{\SEMANTICSHYPERBETA}[3]{\SEMHYPER{\CBSBETAMATH/#1}{#2}{#3}}  % -> \SEMCBS
\newcommand{\SECTIONHYPERBETA}[3]{\SECTHYPER{\CBSBETAMATH/#1}{#2}{#3}}   % -> \SECCBS

% \hyperdef and \hyperref support both internal and external hyperlinks
% (whereas \hypertarget and \hyperlink support only internal hyperlinks)
% See https://tex.stackexchange.com/a/197244 regarding the use of \raisebox

% \LEFTPHRASE MATH \RIGHTPHRASE produces [[ MATH ]] with proper brackets:

\newcommand{\LEFTPHRASE}{\llbracket}
\newcommand{\RIGHTPHRASE}{\rrbracket}

% \LEFTGROUP MATH \RIGHTGROUP produces ( MATH ) where the parentheses are
% highlighted the same  as keywords:

\newcommand{\LEFTGROUP}{\STYLE{Key}{(}}
\newcommand{\RIGHTGROUP}{\STYLE{Key}{)}}

% MATH\PLUS produces a superscript +
% MATH\STAR produces a superscript *
% MATH\QUERY produces a superscript ?

\newcommand{\PLUS}{{}^{\text{\scriptsize+}}}
\newcommand{\STAR}{{}^{\raisebox{-0.5ex}{\text{\scriptsize*}}}}
\newcommand{\QUERY}{{}^{\raisebox{-0.5ex}{\text{\scriptsize?}}}}

% \RULE{premise}{conclusion} produces
%     premise
%   ----------
%   conclusion

\newcommand{\RULE}[2]{\frac{\displaystyle#1}{\displaystyle#2}}
% See https://tex.stackexchange.com/questions/337328/superscripts-appear-in-various-weird-places-in-fractions

% \RULE
%   {\begin{aligned} & premise \\ & ... \end{aligned}}
%   {\begin{aligned} & conclusion ... \\ & ... \end{aligned}}
% produces an inference rule with left-aligned premises and split conclusion
%      premise
%      ...
%   --------------
%   conclusion ...
%   ...

% \TO TYPE produces => TYPE

\newcommand{\TO}{\mathop{\Rightarrow}}

% TERM \TRANS TERM produces TERM ---> TERM

\newcommand{\TRANS}{\longrightarrow}

% TERM \xrightarrow{LABEL} TERM puts the label above the long arrow

% {% endraw %}
